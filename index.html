// Firebase Configuration
var firebaseConfig = {
    apiKey: "AIzaSyActYOn0E0NquJzJE0u8XU4czOFq3k6bBY",
    authDomain: "r-s-coffee-8f31a.firebaseapp.com",
    databaseURL: "https://r-s-coffee-8f31a-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "r-s-coffee-8f31a",
    storageBucket: "r-s-coffee-8f31a.appspot.com",
    messagingSenderId: "1013399945180",
    appId: "1:1013399945180:web:7fe2a6549b76d1dce3d919"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);

// Function to Get Weight from Firebase
function getWeight() {
    firebase.database().ref("/sensor/weight").on("value", snapshot => {
        let weight = snapshot.val();
        document.getElementById("weight").innerText = weight + " g";
    });
}

// Call getWeight() once user logs in
document.getElementById("loginForm").addEventListener("submit", function (e) {
    e.preventDefault();
    let email = document.getElementById("loginEmail").value;
    let password = document.getElementById("loginPassword").value;

    firebase.auth().signInWithEmailAndPassword(email, password)
        .then(() => {
            document.getElementById("loginSection").style.display = "none";
            document.getElementById("dashboardSection").style.display = "block";
            getWeight();  // Start getting weight data
        })
        .catch(error => alert("Error: " + error.message));
});

// Logout Function
document.getElementById("logoutBtn").addEventListener("click", function () {
    firebase.auth().signOut().then(() => {
        document.getElementById("dashboardSection").style.display = "none";
        document.getElementById("loginSection").style.display = "block";
    });
});
