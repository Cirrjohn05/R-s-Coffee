<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Coffee Shop Dashboard</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/raphael@2.3.0/raphael.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/justgage@1.2.2/justgage.min.js"></script>
</head>
<body class="bg-gray-100 flex justify-center items-center h-screen">

    <!-- Dashboard Section -->
    <div id="dashboardSection" class="bg-white p-6 rounded-lg shadow-lg w-96 text-center">
        <h2 class="text-xl font-bold mb-4">Dashboard</h2>
        <p class="text-gray-600">Current Weight:</p>
        <h1 id="weightText" class="text-2xl font-bold text-blue-500">Loading...</h1>
        
        <!-- Gauge Meter -->
        <div id="gaugeContainer" class="mt-4">
            <div id="gauge" style="width: 200px; height: 150px; margin: auto;"></div>
        </div>

        <button id="logoutBtn" class="mt-4 bg-red-500 text-white p-2 rounded hover:bg-red-600 w-full">Log Out</button>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyActYOn0E0NquJzJE0u8XU4czOFq3k6bBY",
            authDomain: "r-s-coffee-8f31a.firebaseapp.com",
            databaseURL: "https://r-s-coffee-8f31a-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "r-s-coffee-8f31a",
            storageBucket: "r-s-coffee-8f31a.appspot.com",
            messagingSenderId: "1013399945180",
            appId: "1:1013399945180:web:7fe2a6549b76d1dce3d919"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        // Initialize Gauge
        var gauge = new JustGage({
            id: "gauge",
            value: 0,
            min: 0,
            max: 5,  // Adjust based on your weight range (e.g., 5kg max)
            title: "Weight (KG)",
            label: "kg",
            gaugeWidthScale: 0.6,
            levelColors: ["#00E676", "#FFEB3B", "#F44336"] // Green, Yellow, Red
        });

        // Function to Get Weight from Firebase
        function getWeight() {
            firebase.database().ref("/sensor/weight").on("value", snapshot => {
                let weight = snapshot.val();
                document.getElementById("weightText").innerText = weight + " KG";
                gauge.refresh(weight);  // Update gauge meter
            });
        }

        getWeight(); // Start fetching weight data

        // Logout Function
        document.getElementById("logoutBtn").addEventListener("click", function () {
            firebase.auth().signOut().then(() => {
                window.location.reload();  // Reload to login page
            });
        });
    </script>

</body>
</html>
